{"ast":null,"code":"var _jsxFileName = \"/home/lennon/Documentos/Programa\\xE7\\xE3o/APP-RECEITAS/projeto-recipes-app/src/Components/ProgressScreen/index.jsx\";\nimport React, { useEffect, useState } from 'react';\nimport { useHistory, useLocation } from 'react-router';\nimport PropTypes from 'prop-types';\nimport copy from 'clipboard-copy';\nimport { singleCocktail } from '../../API/apiCocktails';\nimport { singleMeal } from '../../API/apiMeals';\nimport blackHeartIcon from \"../../images/blackHeartIcon.svg\";\nimport whiteHeartIcon from \"../../images/whiteHeartIcon.svg\";\nimport dateBrModel from '../../helper/dateConverter';\nimport './style.css';\n\nconst ProgressScreen = props => {\n  const {\n    idReceita\n  } = props;\n  const location = useLocation();\n  const history = useHistory();\n  const [recipe, setRecipe] = useState({});\n  const [ingredients, setIngredients] = useState([]);\n  const [copyBtn, setCopyBtn] = useState('Compartilhar');\n  const [favorite, setFavorite] = useState(false);\n  const [complete, setComplete] = useState(true);\n  useEffect(() => {\n    const stringStorage = localStorage.getItem('inProgressRecipes');\n    const jsonStorage = JSON.parse(stringStorage);\n\n    if (location.pathname.includes('comidas')) {\n      singleMeal(idReceita).then(r => {\n        setRecipe(r);\n\n        if (jsonStorage && jsonStorage.meals[idReceita]) {\n          setIngredients(jsonStorage.meals[idReceita]);\n        } else setIngredients(r.ingredients);\n      });\n    } else {\n      singleCocktail(idReceita).then(r => {\n        setRecipe(r);\n\n        if (jsonStorage && jsonStorage.cocktails[idReceita]) {\n          setIngredients(jsonStorage.cocktails[idReceita]);\n        } else setIngredients(r.ingredients);\n      });\n    }\n  }, [idReceita, location.pathname]);\n  useEffect(() => {\n    const path = location.pathname.includes('comidas') ? 'meals' : 'cocktails';\n    const stringStorage = localStorage.getItem('inProgressRecipes');\n    const jsonStorage = JSON.parse(stringStorage);\n\n    if (ingredients.every(elem => elem[1] === true)) {\n      setComplete(false);\n    } else {\n      setComplete(true);\n    }\n\n    const objectStorage = {\n      meals: {},\n      cocktails: {}\n    };\n\n    if (jsonStorage === null) {\n      localStorage.setItem('inProgressRecipes', JSON.stringify(objectStorage));\n    } else {\n      jsonStorage[path][idReceita] = ingredients;\n      localStorage.setItem('inProgressRecipes', JSON.stringify(jsonStorage));\n    }\n  }, [ingredients, idReceita, location.pathname]);\n  useEffect(() => {\n    const stringFavorite = localStorage.getItem('favoriteRecipes');\n    const jsonFavorite = JSON.parse(stringFavorite);\n\n    if (jsonFavorite !== null && jsonFavorite.some(elem => elem.id === idReceita)) {\n      setFavorite(true);\n    }\n  }, [idReceita]);\n\n  const handleProgress = ({\n    target\n  }) => {\n    const {\n      name\n    } = target;\n    const newIngredients = ingredients.map(elem => {\n      if (elem[0] === name) return [elem[0], !elem[1]];\n      return elem;\n    });\n    setIngredients(newIngredients);\n  };\n\n  const copyLink = () => {\n    const typeRecipe = location.pathname.includes('comidas') ? 'comidas' : 'bebidas';\n    setCopyBtn('Link copiado!');\n    return `http://localhost:3000/${typeRecipe}/${idReceita}`;\n  };\n\n  const defineFavorite = () => {\n    if (favorite) {\n      return /*#__PURE__*/React.createElement(\"img\", {\n        \"data-testid\": \"favorite-btn\",\n        src: blackHeartIcon,\n        alt: \"blackHeart\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 9\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"img\", {\n      \"data-testid\": \"favorite-btn\",\n      src: whiteHeartIcon,\n      alt: \"whiteHeart\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 7\n      }\n    });\n  };\n\n  const favoriteBtn = () => {\n    const objRecipe = {\n      id: idReceita,\n      type: recipe.typeRecipe,\n      area: recipe.areaRecipe,\n      category: recipe.categoryRecipe,\n      alcoholicOrNot: recipe.alcoholic,\n      name: recipe.nameRecipe,\n      image: recipe.imgRecipe\n    };\n    const stringFavorite = localStorage.getItem('favoriteRecipes');\n    const jsonFavorite = stringFavorite !== null ? JSON.parse(stringFavorite) : [];\n    const allValue = [...jsonFavorite, objRecipe];\n    const stringRecipe = JSON.stringify(allValue);\n    localStorage.setItem('favoriteRecipes', stringRecipe);\n    setFavorite(!favorite);\n  };\n\n  const doneRecipe = () => {\n    const actualDate = dateBrModel();\n    const objRecipe = {\n      id: idReceita,\n      type: recipe.typeRecipe,\n      area: recipe.areaRecipe,\n      category: recipe.categoryRecipe,\n      alcoholicOrNot: recipe.alcoholic,\n      name: recipe.nameRecipe,\n      image: recipe.imgRecipe,\n      doneDate: actualDate,\n      tags: recipe.tagRecipe\n    };\n    const stringDone = localStorage.getItem('doneRecipes');\n    const jsonDone = stringDone !== null ? JSON.parse(stringDone) : [];\n    const allValue = [...jsonDone, objRecipe];\n    const stringRecipe = JSON.stringify(allValue);\n    localStorage.setItem('doneRecipes', stringRecipe);\n    history.push('/receitas-feitas');\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"image-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: recipe.imgRecipe,\n    alt: \"\",\n    width: \"200\",\n    \"data-testid\": \"recipe-photo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(\"p\", {\n    \"data-testid\": \"recipe-title\",\n    className: \"title-recipe\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }\n  }, recipe.nameRecipe), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    \"data-testid\": \"share-btn\",\n    onClick: () => copy(copyLink()),\n    className: \"share-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 7\n    }\n  }, copyBtn), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    onClick: favoriteBtn,\n    className: \"share-button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }\n  }, defineFavorite()), /*#__PURE__*/React.createElement(\"p\", {\n    \"data-testid\": \"recipe-category\",\n    className: \"instruction-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }\n  }, recipe.categoryRecipe), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-ingredient\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }\n  }, ingredients.map((elem, index) => /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: elem[0],\n    key: elem[0],\n    style: {\n      display: 'block'\n    },\n    \"data-testid\": `${index}-ingredient-step`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"checkbox\",\n    id: elem[0],\n    name: elem[0],\n    checked: elem[1],\n    onChange: handleProgress,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }), `${elem[0]} - ${recipe.measurements[index] || ''}`))), /*#__PURE__*/React.createElement(\"p\", {\n    \"data-testid\": \"instructions\",\n    className: \"instructions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }\n  }, recipe.instructionRecipe), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    \"data-testid\": \"finish-recipe-btn\",\n    disabled: complete,\n    onClick: doneRecipe,\n    className: \"btn-start\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }\n  }, \"Finalizar\"));\n};\n\nexport default ProgressScreen;\nProgressScreen.propTypes = {\n  idReceita: PropTypes.string.isRequired\n};","map":{"version":3,"sources":["/home/lennon/Documentos/Programação/APP-RECEITAS/projeto-recipes-app/src/Components/ProgressScreen/index.jsx"],"names":["React","useEffect","useState","useHistory","useLocation","PropTypes","copy","singleCocktail","singleMeal","dateBrModel","ProgressScreen","props","idReceita","location","history","recipe","setRecipe","ingredients","setIngredients","copyBtn","setCopyBtn","favorite","setFavorite","complete","setComplete","stringStorage","localStorage","getItem","jsonStorage","JSON","parse","pathname","includes","then","r","meals","cocktails","path","every","elem","objectStorage","setItem","stringify","stringFavorite","jsonFavorite","some","id","handleProgress","target","name","newIngredients","map","copyLink","typeRecipe","defineFavorite","blackHeartIcon","whiteHeartIcon","favoriteBtn","objRecipe","type","area","areaRecipe","category","categoryRecipe","alcoholicOrNot","alcoholic","nameRecipe","image","imgRecipe","allValue","stringRecipe","doneRecipe","actualDate","doneDate","tags","tagRecipe","stringDone","jsonDone","push","index","display","measurements","instructionRecipe","propTypes","string","isRequired"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useHistory, useLocation } from 'react-router';\nimport PropTypes from 'prop-types';\nimport copy from 'clipboard-copy';\nimport { singleCocktail } from '../../API/apiCocktails';\nimport { singleMeal } from '../../API/apiMeals';\nimport blackHeartIcon from '../../images/blackHeartIcon.svg';\nimport whiteHeartIcon from '../../images/whiteHeartIcon.svg';\nimport dateBrModel from '../../helper/dateConverter';\nimport './style.css';\n\nconst ProgressScreen = (props) => {\n  const { idReceita } = props;\n  const location = useLocation();\n  const history = useHistory();\n\n  const [recipe, setRecipe] = useState({});\n  const [ingredients, setIngredients] = useState([]);\n  const [copyBtn, setCopyBtn] = useState('Compartilhar');\n  const [favorite, setFavorite] = useState(false);\n  const [complete, setComplete] = useState(true);\n\n  useEffect(() => {\n    const stringStorage = localStorage.getItem('inProgressRecipes');\n    const jsonStorage = JSON.parse(stringStorage);\n\n    if (location.pathname.includes('comidas')) {\n      singleMeal(idReceita).then((r) => {\n        setRecipe(r);\n        if (jsonStorage && jsonStorage.meals[idReceita]) {\n          setIngredients(jsonStorage.meals[idReceita]);\n        } else setIngredients(r.ingredients);\n      });\n    } else {\n      singleCocktail(idReceita).then((r) => {\n        setRecipe(r);\n        if (jsonStorage && jsonStorage.cocktails[idReceita]) {\n          setIngredients(jsonStorage.cocktails[idReceita]);\n        } else setIngredients(r.ingredients);\n      });\n    }\n  }, [idReceita, location.pathname]);\n\n  useEffect(() => {\n    const path = location.pathname.includes('comidas') ? 'meals' : 'cocktails';\n    const stringStorage = localStorage.getItem('inProgressRecipes');\n    const jsonStorage = JSON.parse(stringStorage);\n    if (ingredients.every((elem) => elem[1] === true)) {\n      setComplete(false);\n    } else {\n      setComplete(true);\n    }\n    const objectStorage = {\n      meals: {},\n      cocktails: {},\n    };\n\n    if (jsonStorage === null) {\n      localStorage.setItem('inProgressRecipes', JSON.stringify(objectStorage));\n    } else {\n      jsonStorage[path][idReceita] = ingredients;\n      localStorage.setItem('inProgressRecipes', JSON.stringify(jsonStorage));\n    }\n  }, [ingredients, idReceita, location.pathname]);\n\n  useEffect(() => {\n    const stringFavorite = localStorage.getItem('favoriteRecipes');\n    const jsonFavorite = JSON.parse(stringFavorite);\n\n    if (\n      jsonFavorite !== null\n      && jsonFavorite.some((elem) => elem.id === idReceita)\n    ) {\n      setFavorite(true);\n    }\n  }, [idReceita]);\n\n  const handleProgress = ({ target }) => {\n    const { name } = target;\n    const newIngredients = ingredients.map((elem) => {\n      if (elem[0] === name) return [elem[0], !elem[1]];\n      return elem;\n    });\n    setIngredients(newIngredients);\n  };\n\n  const copyLink = () => {\n    const typeRecipe = location.pathname.includes('comidas')\n      ? 'comidas'\n      : 'bebidas';\n    setCopyBtn('Link copiado!');\n    return `http://localhost:3000/${typeRecipe}/${idReceita}`;\n  };\n\n  const defineFavorite = () => {\n    if (favorite) {\n      return (\n        <img data-testid=\"favorite-btn\" src={ blackHeartIcon } alt=\"blackHeart\" />\n      );\n    }\n    return (\n      <img data-testid=\"favorite-btn\" src={ whiteHeartIcon } alt=\"whiteHeart\" />\n    );\n  };\n\n  const favoriteBtn = () => {\n    const objRecipe = {\n      id: idReceita,\n      type: recipe.typeRecipe,\n      area: recipe.areaRecipe,\n      category: recipe.categoryRecipe,\n      alcoholicOrNot: recipe.alcoholic,\n      name: recipe.nameRecipe,\n      image: recipe.imgRecipe,\n    };\n    const stringFavorite = localStorage.getItem('favoriteRecipes');\n    const jsonFavorite = stringFavorite !== null ? JSON.parse(stringFavorite) : [];\n    const allValue = [...jsonFavorite, objRecipe];\n    const stringRecipe = JSON.stringify(allValue);\n    localStorage.setItem('favoriteRecipes', stringRecipe);\n    setFavorite(!favorite);\n  };\n\n  const doneRecipe = () => {\n    const actualDate = dateBrModel();\n    const objRecipe = {\n      id: idReceita,\n      type: recipe.typeRecipe,\n      area: recipe.areaRecipe,\n      category: recipe.categoryRecipe,\n      alcoholicOrNot: recipe.alcoholic,\n      name: recipe.nameRecipe,\n      image: recipe.imgRecipe,\n      doneDate: actualDate,\n      tags: recipe.tagRecipe,\n    };\n    const stringDone = localStorage.getItem('doneRecipes');\n    const jsonDone = stringDone !== null ? JSON.parse(stringDone) : [];\n    const allValue = [...jsonDone, objRecipe];\n    const stringRecipe = JSON.stringify(allValue);\n    localStorage.setItem('doneRecipes', stringRecipe);\n    history.push('/receitas-feitas');\n  };\n\n  return (\n    <div>\n      <div className=\"image-container\">\n        <img\n          src={ recipe.imgRecipe }\n          alt=\"\"\n          width=\"200\"\n          data-testid=\"recipe-photo\"\n        />\n      </div>\n      <p data-testid=\"recipe-title\" className=\"title-recipe\">\n        {recipe.nameRecipe}\n      </p>\n      <button\n        type=\"button\"\n        data-testid=\"share-btn\"\n        onClick={ () => copy(copyLink()) }\n        className=\"share-button\"\n      >\n        {copyBtn}\n      </button>\n      <button type=\"button\" onClick={ favoriteBtn } className=\"share-button\">\n        {defineFavorite()}\n      </button>\n      <p data-testid=\"recipe-category\" className=\"instruction-title\">\n        {recipe.categoryRecipe}\n      </p>\n      <div className=\"container-ingredient\">\n        {ingredients.map((elem, index) => (\n          <label\n            htmlFor={ elem[0] }\n            key={ elem[0] }\n            style={ { display: 'block' } }\n            data-testid={ `${index}-ingredient-step` }\n          >\n            <input\n              type=\"checkbox\"\n              id={ elem[0] }\n              name={ elem[0] }\n              checked={ elem[1] }\n              onChange={ handleProgress }\n            />\n            {`${elem[0]} - ${recipe.measurements[index] || ''}`}\n          </label>\n        ))}\n      </div>\n      <p data-testid=\"instructions\" className=\"instructions\">\n        {recipe.instructionRecipe}\n      </p>\n      <button\n        type=\"button\"\n        data-testid=\"finish-recipe-btn\"\n        disabled={ complete }\n        onClick={ doneRecipe }\n        className=\"btn-start\"\n      >\n        Finalizar\n      </button>\n    </div>\n  );\n};\n\nexport default ProgressScreen;\n\nProgressScreen.propTypes = {\n  idReceita: PropTypes.string.isRequired,\n};\n"]},"metadata":{},"sourceType":"module"}